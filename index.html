<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°„ë‹¨í•œ ë±€ ê²Œì„</title>
    <script>
        // CSSë„ ë™ì¼í•˜ê²Œ ë²„ì „ ê´€ë¦¬
        const DEV_MODE_CSS = true;
        const VERSION_CSS = '1.0.0';
        
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        if (DEV_MODE_CSS) {
            link.href = `style.css?t=${Date.now()}`;
        } else {
            link.href = `style.css?v=${VERSION_CSS}`;
        }
        document.head.appendChild(link);
    </script>
</head>
<body>
    <div class="version-badge" id="version-badge">v1.0.0</div>
    <div class="container">
        <header>
            <h1>ğŸ ë±€ ê²Œì„</h1>
            <div class="score-board">
                <div class="score">ì ìˆ˜: <span id="score">0</span></div>
                <div class="high-score">ìµœê³  ì ìˆ˜: <span id="high-score">0</span></div>
            </div>
        </header>
        
        <div class="game-area">
            <canvas id="gameCanvas" width="400" height="400"></canvas>
            <div id="gameOver" class="game-over hidden">
                <h2>ê²Œì„ ì˜¤ë²„!</h2>
                <p>ìµœì¢… ì ìˆ˜: <span id="final-score">0</span></p>
                <button id="restart-btn">ë‹¤ì‹œ ì‹œì‘</button>
            </div>
        </div>
        
        <div class="controls">
            <p>ë°©í–¥í‚¤(â†‘â†“â†â†’) ë˜ëŠ” WASD í‚¤ë¡œ ì¡°ì‘í•˜ì„¸ìš”</p>
            <p class="touch-hint">ğŸ“± ëª¨ë°”ì¼/ğŸ–±ï¸ PC: ê²Œì„ í™”ë©´ì„ í„°ì¹˜í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ë°©í–¥ì„ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
            <div class="mobile-controls">
                <button class="control-btn" id="up-btn">â†‘</button>
                <div class="horizontal-controls">
                    <button class="control-btn" id="left-btn">â†</button>
                    <button class="control-btn" id="down-btn">â†“</button>
                    <button class="control-btn" id="right-btn">â†’</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ê°œë°œ ëª¨ë“œ: íƒ€ì„ìŠ¤íƒ¬í”„ ì‚¬ìš© (ìë™ ìºì‹œ ë¬´íš¨í™”) -->
    <!-- ë°°í¬ ëª¨ë“œ: ë²„ì „ ë²ˆí˜¸ ì‚¬ìš© (ì˜ˆ: game.js?v=1.0.0) -->
    <script>
        // ê°œë°œ ì¤‘ì—ëŠ” íƒ€ì„ìŠ¤íƒ¬í”„ ì‚¬ìš©, ë°°í¬ ì‹œì—ëŠ” ë²„ì „ ë²ˆí˜¸ ì‚¬ìš©
        const DEV_MODE = true; // ë°°í¬ ì‹œ falseë¡œ ë³€ê²½
        let VERSION = '1.0.0'; // ì´ˆê¸° ë²„ì „
        
        // ë²„ì „ ê´€ë¦¬ í•¨ìˆ˜ - íŒŒì¼ ì €ì¥ ì‹œì  ê°ì§€
        function getVersion() {
            const versionKey = 'snakeGameVersion';
            const lastFileHashKey = 'snakeGameLastFileHash';
            
            if (DEV_MODE) {
                // ê°œë°œ ëª¨ë“œ: íŒŒì¼ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ê°ì§€í•˜ì—¬ ë²„ì „ ì¦ê°€
                let version = localStorage.getItem(versionKey);
                
                if (!version) {
                    // ì²˜ìŒ ë¡œë“œ: ì´ˆê¸° ë²„ì „ ì„¤ì •
                    version = VERSION;
                    localStorage.setItem(versionKey, version);
                }
                
                // í˜„ì¬ í˜ì´ì§€ì˜ ìŠ¤í¬ë¦½íŠ¸ í•´ì‹œ ìƒì„± (ê°„ë‹¨í•œ ë°©ë²•: URLì˜ íƒ€ì„ìŠ¤íƒ¬í”„ ì‚¬ìš©)
                // ì‹¤ì œë¡œëŠ” íŒŒì¼ ë‚´ìš©ì˜ í•´ì‹œë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ì§€ë§Œ, íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ëŒ€ì²´
                const currentHash = window.location.href + Date.now();
                const lastHash = localStorage.getItem(lastFileHashKey);
                
                // íŒŒì¼ì´ ë³€ê²½ë˜ì—ˆê±°ë‚˜ ì²˜ìŒ ë¡œë“œì¸ ê²½ìš° ë²„ì „ ì¦ê°€
                // (ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ íŒŒì¼ì˜ ë§ˆì§€ë§‰ ìˆ˜ì • ì‹œê°„ì„ ì²´í¬í•´ì•¼ í•˜ì§€ë§Œ,
                // ê°œë°œ í™˜ê²½ì—ì„œëŠ” ìƒˆë¡œê³ ì¹¨í•  ë•Œë§ˆë‹¤ ë²„ì „ ì¦ê°€ë¡œ ì²˜ë¦¬)
                if (!lastHash || lastHash !== currentHash) {
                    // ì§§ì€ ì‹œê°„ ë‚´ ì¤‘ë³µ ì¦ê°€ ë°©ì§€ (1ì´ˆ ì´ë‚´ ìƒˆë¡œê³ ì¹¨ì€ ë¬´ì‹œ)
                    const lastUpdate = localStorage.getItem('snakeGameLastUpdate');
                    const now = Date.now();
                    
                    if (!lastUpdate || (now - parseInt(lastUpdate)) > 1000) {
                        version = incrementVersion(version);
                        localStorage.setItem(versionKey, version);
                        localStorage.setItem('snakeGameLastUpdate', now.toString());
                        console.log('Version updated to:', version);
                    }
                }
                
                // í˜„ì¬ í•´ì‹œ ì €ì¥ (ì‹¤ì œë¡œëŠ” íŒŒì¼ ë‚´ìš© í•´ì‹œë¥¼ ì €ì¥í•´ì•¼ í•¨)
                localStorage.setItem(lastFileHashKey, currentHash);
                
                return version;
            } else {
                // ë°°í¬ ëª¨ë“œ: ê³ ì • ë²„ì „ ì‚¬ìš©
                return VERSION;
            }
        }
        
        // ë²„ì „ ì¦ê°€ í•¨ìˆ˜ (ì˜ˆ: 1.0.0 -> 1.0.1 -> 1.0.2 ...)
        function incrementVersion(version) {
            const parts = version.split('.');
            let major = parseInt(parts[0]) || 1;
            let minor = parseInt(parts[1]) || 0;
            let patch = parseInt(parts[2]) || 0;
            
            // íŒ¨ì¹˜ ë²„ì „ ì¦ê°€
            patch++;
            
            // íŒ¨ì¹˜ê°€ 100ì„ ë„˜ìœ¼ë©´ ë§ˆì´ë„ˆ ì¦ê°€
            if (patch >= 100) {
                patch = 0;
                minor++;
            }
            
            // ë§ˆì´ë„ˆê°€ 100ì„ ë„˜ìœ¼ë©´ ë©”ì´ì € ì¦ê°€
            if (minor >= 100) {
                minor = 0;
                major++;
            }
            
            return `${major}.${minor}.${patch}`;
        }
        
        // ë²„ì „ ê°€ì ¸ì˜¤ê¸° ë° í‘œì‹œ
        VERSION = getVersion();
        document.getElementById('version-badge').textContent = `v${VERSION}`;
        
        // ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ë° ì‹¤í–‰
        function loadGameScript() {
            const script = document.createElement('script');
            const timestamp = Date.now();
            
            if (DEV_MODE) {
                // ê°œë°œ ëª¨ë“œ: íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ìºì‹œ ë¬´íš¨í™” ë° ë²„ì „ ì¦ê°€
                script.src = `game.js?t=${timestamp}`;
                
                // íŒŒì¼ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ê°ì§€ (íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜)
                const lastScriptTimeKey = 'snakeGameLastScriptTime';
                const lastScriptTime = localStorage.getItem(lastScriptTimeKey);
                
                // ì´ì „ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹œê°„ê³¼ ë¹„êµí•˜ì—¬ ë²„ì „ ì¦ê°€
                if (lastScriptTime && (timestamp - parseInt(lastScriptTime)) > 2000) {
                    // 2ì´ˆ ì´ìƒ ì§€ë‚¬ìœ¼ë©´ íŒŒì¼ì´ ì €ì¥ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼í•˜ê³  ë²„ì „ ì¦ê°€
                    const versionKey = 'snakeGameVersion';
                    let currentVersion = localStorage.getItem(versionKey) || VERSION;
                    currentVersion = incrementVersion(currentVersion);
                    localStorage.setItem(versionKey, currentVersion);
                    VERSION = currentVersion;
                    
                    // ë²„ì „ ë°°ì§€ ì—…ë°ì´íŠ¸
                    const versionBadge = document.getElementById('version-badge');
                    if (versionBadge) {
                        versionBadge.textContent = `v${currentVersion}`;
                    }
                    
                    console.log('Version incremented to:', currentVersion);
                }
                
                localStorage.setItem(lastScriptTimeKey, timestamp.toString());
            } else {
                // ë°°í¬ ëª¨ë“œ: ë²„ì „ ë²ˆí˜¸ ì‚¬ìš©
                script.src = `game.js?v=${VERSION}`;
            }
            
            script.onload = function() {
                console.log('Game script loaded successfully');
                // ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í›„ ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ê³  ê²Œì„ ì‹œì‘
                setTimeout(function() {
                    if (typeof startGame === 'function') {
                        startGame();
                    } else {
                        console.error('startGame function not found');
                    }
                }, 100);
            };
            script.onerror = function() {
                console.error('Failed to load game script');
            };
            document.body.appendChild(script);
        }
        
        // DOMì´ ì¤€ë¹„ë˜ë©´ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadGameScript);
        } else {
            loadGameScript();
        }
    </script>
</body>
</html>

